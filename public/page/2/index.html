<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="我要一步一步往上爬，只待阳光静静看着它的脸，小小的天有大大的梦想，重重的壳裹着轻轻的仰望。">
<meta property="og:type" content="website">
<meta property="og:title" content="SchafferWang&#39;s blogs">
<meta property="og:url" content="http://SchafferWang0818.github.io/page/2/index.html">
<meta property="og:site_name" content="SchafferWang&#39;s blogs">
<meta property="og:description" content="我要一步一步往上爬，只待阳光静静看着它的脸，小小的天有大大的梦想，重重的壳裹着轻轻的仰望。">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="SchafferWang&#39;s blogs">
<meta name="twitter:description" content="我要一步一步往上爬，只待阳光静静看着它的脸，小小的天有大大的梦想，重重的壳裹着轻轻的仰望。">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://SchafferWang0818.github.io/page/2/"/>





  <title>SchafferWang's blogs</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">SchafferWang's blogs</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Writed by SchafferWang</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://SchafferWang0818.github.io/2018/03/21/Android之虚拟机/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="SchafferWang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://b107.photo.store.qq.com/psb?/V13TTKNS3RSxL2/w9lSgrOJ.PUBfNGq5Og3KsXpTRlFWY*M0I168fsA4us!/b/dGsAAAAAAAAA&bo=VgOAAgAAAAAFB*M!&rf=viewer_4">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SchafferWang's blogs">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/21/Android之虚拟机/" itemprop="url">Android之虚拟机</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-21T13:35:40+08:00">
                2018-03-21
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/android-总结/" itemprop="url" rel="index">
                    <span itemprop="name">android 总结</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="JVM"><a href="#JVM" class="headerlink" title="JVM"></a>JVM</h2><p><strong>包含有JVM的JRE为JDK提供java应用程序最低要求的<font color="red">环境</font>。</strong></p>
<p><strong>JAVA虚拟机运行的是JAVA字节码。</strong></p>
<p><strong>JVM基于栈。</strong>程序在运行时虚拟机需要频繁的从栈上读取写入数据，这个过程需要更多的指令分派与内存访问次数，会耗费很多CPU时间。</p>
<h3 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h3><ol>
<li>启动：任何一个拥有main函数的class都可以作为JVM实例运行的起点</li>
<li>运行：main函数为起点，程序中的其他线程均由它启动，包括daemon守护线程和non-daemon普通线程。daemon是JVM自己使用的线程比如GC线程，main方法的初始线程是non-daemon。</li>
<li>消亡：所有线程终止时，JVM实例结束生命。</li>
</ol>
<hr>
<h2 id="Dalvik"><a href="#Dalvik" class="headerlink" title="Dalvik"></a>Dalvik</h2><p>Dalvik是Google公司自己设计用于Android平台的Java虚拟机。Dalvik虚拟机是Google等厂商合作开发的Android移动设备平台的核心组成部分之一。它可以支持已转换为 .dex（即Dalvik Executable）格式的Java应用程序的运行，.dex格式是专为Dalvik设计的一种压缩格式，适合<strong>内存和处理器速度有限</strong>的系统。Dalvik 经过优化，允许<strong>在有限的内存中同时运行多个虚拟机</strong>的实例，并且<strong>每一个Dalvik 应用作为一个独立的Linux 进程执行</strong>。独立的进程可以防止在虚拟机崩溃的时候所有程序都被关闭。</p>
<p>Dalvik是依靠一个<strong>Just-In-Time (JIT)</strong>编译器去解释字节码。开发者编译后的应用代码需要通过一个解释器在用户的设备上运行，这一机制并不高效，但<strong>让应用能更容易在不同硬件和架构上运行</strong>。</p>
<p><strong>Dalvik虚拟机运行的是Dalvik字节码。</strong>依靠<strong>Just-In-Time (JIT)</strong>编译器去解释执行，运行时动态地将执行频率很高的dex字节码翻译成本地机器码，然后在执行，但是将dex字节码翻译成本地机器码是发生在应用程序的运行过程中，并且应用程序每一次重新运行的时候，都要重新做这个翻译工作，因此，及时采用了JIT，Dalvik虚拟机的总体性能还是不能与直接执行本地机器码的ART虚拟机相比。</p>
<p><strong>DVM基于寄存器。</strong>数据的访问通过寄存器间直接传递，这样的访问方式比基于栈方式要快很多。</p>
<hr>
<h2 id="AndroidRuntime"><a href="#AndroidRuntime" class="headerlink" title="AndroidRuntime"></a>AndroidRuntime</h2><p> ART代表Android Runtime，在应用安装时就<strong>预编译字节码到机器语言</strong>，这一机制叫<strong>Ahead-Of-Time (AOT），编译由 ART 的 dex2oat 工具执行</strong>。在移除解释代码这一过程后，<strong>应用程序执行将更有效率，启动更快。</strong><a href="https://developer.android.google.cn/guide/practices/verifying-apps-art.html?hl=zh-cn" target="_blank" rel="noopener"><strong>ART 的 JNI 比 Dalvik 的 JNI 更为严格一些。</strong></a></p>
<ul>
<li><p>AOT的编译器分两种模式：</p>
<ul>
<li>开发: 在开发机上编译预装应用；</li>
<li>安装: 在设备上编译新安装的应用,在应用安装时将dex字节码翻译成本地机器码。<br><br></li>
</ul>
</li>
<li><p>ART优点:</p>
<ul>
<li>系统性能的显著提升。</li>
<li>应用启动更快、运行更快、体验更流畅、触感反馈更及时。</li>
<li>更长的电池续航能力。</li>
<li>支持更低的硬件。</li>
</ul>
</li>
<li><p>ART缺点:</p>
<ul>
<li>更大的存储空间占用，可能会增加10%-20%。</li>
<li>更长的应用安装时间。</li>
</ul>
</li>
</ul>
<hr>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://SchafferWang0818.github.io/2018/03/21/Android之辅助——gradle/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="SchafferWang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://b107.photo.store.qq.com/psb?/V13TTKNS3RSxL2/w9lSgrOJ.PUBfNGq5Og3KsXpTRlFWY*M0I168fsA4us!/b/dGsAAAAAAAAA&bo=VgOAAgAAAAAFB*M!&rf=viewer_4">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SchafferWang's blogs">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/21/Android之辅助——gradle/" itemprop="url">Android之 Gradle</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-21T13:35:40+08:00">
                2018-03-21
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/android-总结/" itemprop="url" rel="index">
                    <span itemprop="name">android 总结</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Gradle"><a href="#Gradle" class="headerlink" title="Gradle"></a>Gradle</h1><pre><code>参考博客与文献:
    - https://www.cniao5.com/forum/thread/9b50d2fc11d111e782d600163e0230fa
    - http://blog.csdn.net/l664675249/article/details/50556133
</code></pre><p>项目文件结构</p>
<p><img src="http://cniao5-imgs.qiniudn.com/o_1bc49l7oi1paa1am6fo919nesh57.png" alt="项目文件结构"></p>
<table>
<thead>
<tr>
<th>目录文件</th>
<th>定义</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>.gradle</code></td>
<td>gradle项目产生文件（自动编译工具产生的文件）</td>
</tr>
<tr>
<td><code>.idea</code></td>
<td>IDEA项目文件（开发工具产生的文件）</td>
</tr>
<tr>
<td><strong>app</strong></td>
<td>其中一个 module，复用父项目的设置，可与父项目拥有相同的配置文件</td>
</tr>
<tr>
<td>`build</td>
<td>自动构建时生成文件的地方</td>
</tr>
<tr>
<td><strong>gradle \</strong></td>
<td>自动完成 gradle 环境支持文件夹</td>
</tr>
<tr>
<td><code>.gitignore</code></td>
<td>git源码管理文件</td>
</tr>
<tr>
<td><strong>build.gradle</strong></td>
<td>gradle 项目自动编译的配置文件</td>
</tr>
<tr>
<td><font color="red"><strong>gradle.properties</strong></font></td>
<td>gradle 运行环境配置文件</td>
</tr>
<tr>
<td><code>gradlew</code></td>
<td>自动完成 gradle 环境的 linux mac 脚本，配合 gradle 文件夹使用</td>
</tr>
<tr>
<td><code>gradlew.bat</code></td>
<td>自动完成 gradle 环境的 windows 脚本，配合 gradle 文件夹使用</td>
</tr>
<tr>
<td><code>local.properties</code></td>
<td>Android SDK NDK 环境路径配置</td>
</tr>
<tr>
<td><code>*.iml</code></td>
<td>IDEA 项目文件</td>
</tr>
<tr>
<td><strong>setting.gradle</strong></td>
<td>gradle 项目的子项目包含文件</td>
</tr>
</tbody>
</table>
<hr>
<h3 id="gradle-properties-in-Project"><a href="#gradle-properties-in-Project" class="headerlink" title="gradle.properties in Project"></a><font color="red"><code>gradle.properties</code></font> in Project</h3><p>一个配置全局的管理文件。<font color="red"><strong>可以配置用于全局的属性的文件。</strong></font><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"># Project-wide Gradle settings.</span><br><span class="line"></span><br><span class="line"># IDE (e.g. Android Studio) users:</span><br><span class="line"># Gradle settings configured through the IDE *will override*</span><br><span class="line"># any settings specified in this file.</span><br><span class="line"></span><br><span class="line"># For more details on how to configure your build environment visit</span><br><span class="line"># http://www.gradle.org/docs/current/userguide/build_environment.html</span><br><span class="line"></span><br><span class="line"># Specifies the JVM arguments used for the daemon process.</span><br><span class="line"># The setting is particularly useful for tweaking memory settings.</span><br><span class="line"># JVM 内存调整</span><br><span class="line">org.gradle.jvmargs=-Xmx1536m</span><br><span class="line"></span><br><span class="line"># When configured, Gradle will run in incubating parallel mode.</span><br><span class="line"># This option should only be used with decoupled projects. More details, visit</span><br><span class="line"># http://www.gradle.org/docs/current/userguide/multi_project_builds.html#sec:decoupled_projects</span><br><span class="line"># org.gradle.parallel=true</span><br><span class="line"># Project-wide Gradle settings.</span><br><span class="line"></span><br><span class="line">#添加ndk支持(按需添加)</span><br><span class="line">android.useDeprecatedNdk=true</span><br><span class="line"># 应用版本名称</span><br><span class="line">VERSION_NAME=1.0.0</span><br><span class="line"># 应用版本号</span><br><span class="line">VERSION_CODE=100</span><br><span class="line"># 支持库版本</span><br><span class="line">SUPPORT_LIBRARY=24.2.1</span><br><span class="line"># MIN_SDK_VERSION</span><br><span class="line">ANDROID_BUILD_MIN_SDK_VERSION=14</span><br><span class="line"># TARGET_SDK_VERSION</span><br><span class="line">ANDROID_BUILD_TARGET_SDK_VERSION=24</span><br><span class="line"># BUILD_SDK_VERSION</span><br><span class="line">ANDROID_BUILD_SDK_VERSION=24</span><br><span class="line"># BUILD_TOOLS_VERSION</span><br><span class="line">ANDROID_BUILD_TOOLS_VERSION=24.0.3</span><br></pre></td></tr></table></figure></p>
<p>配置属性使用示例:(注: “<code>as int</code>“ 用于将String类型转换成int类型)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">    compileSdkVersion project.ANDROID_BUILD_SDK_VERSION as int</span><br><span class="line">    buildToolsVersion project.ANDROID_BUILD_TOOLS_VERSION</span><br><span class="line"></span><br><span class="line">    defaultConfig &#123;</span><br><span class="line">        applicationId project.APPLICATION_ID</span><br><span class="line">        versionCode project.VERSION_CODE as int</span><br><span class="line">        versionName project.VERSION_NAME</span><br><span class="line">        minSdkVersion project.ANDROID_BUILD_MIN_SDK_VERSION as int</span><br><span class="line">        targetSdkVersion project.ANDROID_BUILD_TARGET_SDK_VERSION as int</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dependencies &#123;</span><br><span class="line">    compile fileTree(include: [&apos;*.jar&apos;], dir: &apos;libs&apos;)</span><br><span class="line">    //这里注意是双引号</span><br><span class="line">    compile &quot;com.android.support:appcompat-v7:$&#123;SUPPORT_LIBRARY&#125;&quot;</span><br><span class="line">    compile &quot;com.android.support:design:$&#123;SUPPORT_LIBRARY&#125;&quot;</span><br><span class="line">    compile &quot;com.android.support:recyclerview-v7:$&#123;SUPPORT_LIBRARY&#125;&quot;</span><br><span class="line">    compile &quot;com.android.support:support-annotations:$&#123;SUPPORT_LIBRARY&#125;&quot;</span><br><span class="line">    compile &quot;com.android.support:cardview-v7:$&#123;SUPPORT_LIBRARY&#125;&quot;</span><br><span class="line">    compile &quot;com.android.support:support-v4:$&#123;SUPPORT_LIBRARY&#125;&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="build-gradle-in-Module"><a href="#build-gradle-in-Module" class="headerlink" title="build.gradle in Module"></a>build.gradle in Module</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apply plugin: &apos;com.android.application&apos;</span><br><span class="line">//apply plugin: &apos;realm-android&apos;</span><br><span class="line">apply from: &apos;tinker-support.gradle&apos;</span><br></pre></td></tr></table></figure>
<ul>
<li>描述 Gradle 所引入的插件，这里表示该 module 是一个 Android Application。插件里面包含了 Android 项目相关的所有工具。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">	//编译的 SDK 版本</span><br><span class="line">    compileSdkVersion rootProject.ext.android.compileSdkVersion</span><br><span class="line">	//编译工具版本 </span><br><span class="line">    buildToolsVersion rootProject.ext.android.buildToolsVersion	</span><br><span class="line">    defaultConfig &#123;</span><br><span class="line">        applicationId &quot;com.billliao.fentu&quot;</span><br><span class="line">        minSdkVersion rootProject.ext.android.minSdkVersion</span><br><span class="line">        targetSdkVersion rootProject.ext.android.targetSdkVersion</span><br><span class="line">        versionCode rootProject.ext.android.versionCode</span><br><span class="line">        versionName rootProject.ext.android.versionName</span><br><span class="line">        testInstrumentationRunner &quot;android.support.test.runner.AndroidJUnitRunner&quot;</span><br><span class="line">        multiDexEnabled true</span><br><span class="line">        manifestPlaceholders = [</span><br><span class="line">                JPUSH_PKGNAME: &quot;com.billliao.fentu&quot;,</span><br><span class="line">                JPUSH_APPKEY : &quot;f87de2dd52b40938233b7add&quot;</span><br><span class="line">        ]</span><br><span class="line">        vectorDrawables.useSupportLibrary = true</span><br><span class="line">        ndk &#123;</span><br><span class="line">            abiFilters &apos;armeabi&apos;, &apos;x86&apos;, &apos;armeabi-v7a&apos;//, &apos;x86_64&apos;, &apos;arm64-v8a&apos;, &apos;mips&apos;, &apos;mips64&apos;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    signingConfigs &#123;</span><br><span class="line">        config &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                keyAlias &apos;fentu&apos;</span><br><span class="line">                keyPassword &apos;yglfentu&apos;</span><br><span class="line">                storeFile file(&apos;C:/appkey/fentu.jks&apos;)</span><br><span class="line">                storePassword &apos;yglfentu&apos;</span><br><span class="line">            &#125; catch (ex) &#123;</span><br><span class="line">                throw new InvalidUserDataException(ex.toString())</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        debug_config &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                keyAlias &apos;fentu&apos;</span><br><span class="line">                keyPassword &apos;yglfentu&apos;</span><br><span class="line">                storeFile file(&apos;C:/appkey/fentu.jks&apos;)</span><br><span class="line">                storePassword &apos;yglfentu&apos;</span><br><span class="line">            &#125; catch (ex) &#123;</span><br><span class="line">                throw new InvalidUserDataException(ex.toString())</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    buildTypes &#123;</span><br><span class="line">        release &#123;</span><br><span class="line">            signingConfig signingConfigs.config</span><br><span class="line">            buildConfigField &quot;boolean&quot;, &quot;LOG_DEBUG&quot;, &quot;false&quot;</span><br><span class="line">            zipAlignEnabled true</span><br><span class="line">            minifyEnabled true</span><br><span class="line">            shrinkResources true</span><br><span class="line">            proguardFiles getDefaultProguardFile(&apos;proguard-android.txt&apos;), &apos;proguard-rules.pro&apos;</span><br><span class="line">        &#125;</span><br><span class="line">        debug &#123;</span><br><span class="line">            buildConfigField &quot;boolean&quot;, &quot;LOG_DEBUG&quot;, &quot;true&quot;</span><br><span class="line">            versionNameSuffix &quot;-debug&quot;</span><br><span class="line">            minifyEnabled false</span><br><span class="line">            zipAlignEnabled false</span><br><span class="line">            shrinkResources false</span><br><span class="line">            signingConfig signingConfigs.debug_config</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    lintOptions &#123;</span><br><span class="line">        checkReleaseBuilds false     //在打包Release版本的时候进行(多语言等)检测</span><br><span class="line">        abortOnError false              //打包报错是否停止打包</span><br><span class="line">    &#125;</span><br><span class="line">    packagingOptions &#123;</span><br><span class="line">        exclude &apos;META-INF/LICENSE.txt&apos;</span><br><span class="line">        exclude &apos;META-INF/NOTICE.txt&apos;</span><br><span class="line">        exclude &apos;META-INF/license.txt&apos;</span><br><span class="line">        exclude &apos;META-INF/LICENSE&apos;</span><br><span class="line">        exclude &apos;META-INF/notice.txt&apos;</span><br><span class="line">        exclude &apos;META-INF/NOTICE&apos;</span><br><span class="line">        exclude &apos;META-INF/DEPENDENCIES.txt&apos;</span><br><span class="line">        exclude &apos;META-INF/DEPENDENCIES&apos;</span><br><span class="line">    &#125;</span><br><span class="line">    sourceSets &#123;</span><br><span class="line">        main &#123;</span><br><span class="line">            jniLibs.srcDirs = [&apos;libs&apos;]</span><br><span class="line">            assets.srcDirs = [&apos;src/main/assets&apos;, &apos;src/main/assets/&apos;]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	</span><br><span class="line">	//productFlavors里的配置会覆盖defaultConfig里的配置</span><br><span class="line">    productFlavors &#123;</span><br><span class="line">        yingyongbao &#123;&#125;</span><br><span class="line">        taobao &#123;&#125;</span><br><span class="line">        slzerohelper &#123;&#125;</span><br><span class="line">        xiaomi &#123;&#125;</span><br><span class="line">        huawei &#123;&#125;</span><br><span class="line">        oppo &#123;&#125;</span><br><span class="line">        vivo &#123;&#125;</span><br><span class="line">        productFlavors.all &#123; flavor -&gt;</span><br><span class="line">            flavor.manifestPlaceholders = [UMENG_CHANNEL_VALUE: name]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>描述了该 Android module 构建过程中所用到的所有参数。默认情况下，IDE 会自动创建 compileSdkVersion、buildToolsVersion 两个参数，分别对应编译的 SDK 版本和 Android build tools 版本。</li>
<li>在 android 代码块内，系统还默认创建了两个代码块——defaultConfig 和 buildTypes<ul>
<li>动态的在build时配置AndroidManifest.xml里的项目，defaultConfig里的配置可以覆盖manifest里的配置。</li>
<li>buildTypes 配置如何构建和打包你的App，默认有debug和release两个类型。debug类型包含调试时的信息，并且有debug key签名。release默认是不含签名的。</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">	// 依赖libs/下所有jar包</span><br><span class="line">    compile fileTree(include: [&apos;*.jar&apos;], dir: &apos;libs&apos;)</span><br><span class="line"></span><br><span class="line">	compile files(&apos;libs/alipaySdk-20170623-proguard.jar&apos;)</span><br><span class="line">    compile files(&apos;libs/umeng-analytics-7.4.0.jar&apos;)</span><br><span class="line">    compile files(&apos;libs/umeng-common-1.4.0.jar&apos;)</span><br><span class="line">    compile files(&apos;libs/AMap3DMap_5.6.0_AMapSearch_5.5.0_AMapLocation_3.6.1_20171128.jar&apos;)</span><br><span class="line"></span><br><span class="line">    androidTestCompile(&apos;com.android.support.test.espresso:espresso-core:2.2.2&apos;, &#123;</span><br><span class="line">        exclude group: &apos;com.android.support&apos;, module: &apos;support-annotations&apos;</span><br><span class="line">    &#125;)</span><br><span class="line">    testCompile &apos;junit:junit:4.12&apos;</span><br><span class="line"></span><br><span class="line">	// 远程的二进制依赖</span><br><span class="line">	compile &apos;com.android.support:appcompat-v7:19.0.1&apos;</span><br><span class="line">    compile rootProject.ext.dependencies[&quot;appcompat-v7&quot;]</span><br><span class="line">    debugCompile rootProject.ext.dependencies[&quot;leak&quot;]</span><br><span class="line">    releaseCompile rootProject.ext.dependencies[&quot;leak_no&quot;]</span><br><span class="line">	</span><br><span class="line">	//模块依赖</span><br><span class="line">    compile project(&apos;:scan&apos;)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>描述了该 Android module 构建过程中所依赖的所有库，库可以是<strong><code>以 jar 的形式</code></strong>进行依赖，或者是使用 Android 推荐的 <strong><code>aar 形式</code></strong>进行依赖。</li>
<li>aar 相对于 jar 具有不可比拟的优势，不仅配置依赖更简单，而且可以将图片的资源文件放入 aar 中供主项目依赖，几乎等于依赖了源码。<font color="red">Gradle 对于依赖关系的处理，就是向调用者屏蔽所有的依赖关系，<strong>主项目只需要依赖该 aar 库项目，而不需要知道 aar 项目对于其他库的依赖</strong>。</font></li>
</ul>
<hr>
<h3 id="build-gradle-in-Project"><a href="#build-gradle-in-Project" class="headerlink" title="build.gradle in Project"></a>build.gradle in Project</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">// Top-level build file where you can add configuration options common to all sub-projects/modules.</span><br><span class="line">apply from: &quot;dependencySetting.gradle&quot;</span><br><span class="line"></span><br><span class="line">//指定了使用 jcenter 代码仓库，同时声明依赖的 Android Gradle 插件的版本。</span><br><span class="line">buildscript &#123;</span><br><span class="line">    repositories &#123;</span><br><span class="line">        jcenter()</span><br><span class="line">    &#125;</span><br><span class="line">    dependencies &#123;</span><br><span class="line">        classpath &apos;com.android.tools.build:gradle:2.3.2&apos;</span><br><span class="line">        classpath &quot;com.tencent.bugly:tinker-support:1.0.8&quot;</span><br><span class="line">        classpath &quot;io.realm:realm-gradle-plugin:2.0.2&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//为项目整体配置的一些属性。</span><br><span class="line">allprojects &#123;</span><br><span class="line">    repositories &#123;</span><br><span class="line">        jcenter()</span><br><span class="line">        maven &#123;</span><br><span class="line">            url &quot;https://maven.google.com&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">task clean(type: Delete) &#123;</span><br><span class="line">    delete rootProject.buildDir</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="gradle-gradle-wrapper-propertes-配置解析"><a href="#gradle-gradle-wrapper-propertes-配置解析" class="headerlink" title="gradle \ gradle-wrapper.propertes 配置解析"></a><code>gradle \ gradle-wrapper.propertes</code> 配置解析</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># Mon Dec 28 10:00:20 PST 2015</span><br><span class="line">distributionBase=GRADLE_USER_HOME</span><br><span class="line">distributionPath=wrapper/dists</span><br><span class="line">zipStoreBase=GRADLE_USER_HOME</span><br><span class="line">zipStorePath=wrapper/dists</span><br><span class="line">distributionUrl=https\://services.gradle.org/distributions/gradle-2.14.1-all.zip</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># GRADLE_USER_HOME (Windows) C:\Users\&lt;user_name&gt;\.gradle\；(Linux) ~/.gradle 。</span><br><span class="line"># distributionBase / distributionPath ，是解压 gradle-2.14.1-all.zip 之后的文件的存放位置。</span><br><span class="line"># zipStoreBase / zipStorePath ，是下载的 gradle-2.14.1-all.zip 所存放的位置。</span><br><span class="line"># distributionUrl 是要下载的 gradle 的地址</span><br><span class="line"># C:\Users\AndroidSchaffer\.gradle\wrapper\dists\gradle-2.14.1-all\8bnwg5hd3w55iofp58khbp6yv\gradle-2.14.1\</span><br><span class="line"># 上述文件夹中的\8bnwg5hd3w55iofp58khbp6yv\层级是根据 解压路径 字符串计算 md5 值得来的</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="local-properties"><a href="#local-properties" class="headerlink" title="local.properties"></a>local.properties</h3><p>用于SDK , NDK 本地路径配置。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">## This file is automatically generated by Android Studio.</span><br><span class="line"># Do not modify this file -- YOUR CHANGES WILL BE ERASED!</span><br><span class="line">#</span><br><span class="line"># This file must *NOT* be checked into Version Control Systems,</span><br><span class="line"># as it contains information specific to your local configuration.</span><br><span class="line">#</span><br><span class="line"># Location of the SDK. This is only used by Gradle.</span><br><span class="line"># For customization when using a Version Control System, please read the</span><br><span class="line"># header note.</span><br><span class="line">#Fri Aug 25 13:30:56 CST 2017</span><br><span class="line">ndk.dir=D\:\\Android\\sdk\\ndk-bundle</span><br><span class="line">sdk.dir=D\:\\Android\\sdk</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="setting-gradle"><a href="#setting-gradle" class="headerlink" title="setting.gradle"></a>setting.gradle</h3><p>用于本地项目判断存在的<code>module</code>名称.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">include &apos;:app&apos;, &apos;:scan&apos;</span><br></pre></td></tr></table></figure>
<hr>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://SchafferWang0818.github.io/2018/03/21/Android之自定义控件——滑动,滚动/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="SchafferWang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://b107.photo.store.qq.com/psb?/V13TTKNS3RSxL2/w9lSgrOJ.PUBfNGq5Og3KsXpTRlFWY*M0I168fsA4us!/b/dGsAAAAAAAAA&bo=VgOAAgAAAAAFB*M!&rf=viewer_4">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SchafferWang's blogs">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/21/Android之自定义控件——滑动,滚动/" itemprop="url">Android 滑动 & 滚动</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-21T13:35:40+08:00">
                2018-03-21
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/android-总结/" itemprop="url" rel="index">
                    <span itemprop="name">android 总结</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="滑动-amp-滚动"><a href="#滑动-amp-滚动" class="headerlink" title="滑动 &amp; 滚动"></a>滑动 &amp; 滚动</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">滑动:</span><br><span class="line"></span><br><span class="line">	- translationX / translationY : 动画更改原位置的相对位置的虚假效果;</span><br><span class="line"></span><br><span class="line">	- 布局参数动态更改</span><br><span class="line"></span><br><span class="line">		- left/right/top/bottom:</span><br><span class="line"></span><br><span class="line">			- layout(getLeft()+offsetX,...);</span><br><span class="line"></span><br><span class="line">			- offsetLeftAndRight(offsetX),offsetTopAndBottom(offsetY);</span><br><span class="line"></span><br><span class="line">		- (Margin)LayoutParams 对View本身的动态增加的真实效果;</span><br><span class="line"></span><br><span class="line">			- setMargins(offsetX,...),效果等同于offsetLeftAndRight()...;</span><br><span class="line"></span><br><span class="line">			- lp.leftMargin = getLeft()+offsetX...,效果等同于layout();</span><br><span class="line"></span><br><span class="line">滚动:</span><br><span class="line">	- scrollTo()/scrollBy() : 对View内部的滚动位置的更改;</span><br><span class="line">		触发OnScrollChangeListener#onScrollChange</span><br><span class="line">		(View v, int scrollX, int scrollY, int oldScrollX, int oldScrollY);</span><br><span class="line">		</span><br><span class="line"></span><br><span class="line">	- Scroller</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="scrollTo-scrollBy"><a href="#scrollTo-scrollBy" class="headerlink" title="scrollTo()/scrollBy()"></a>scrollTo()/scrollBy()</h3><font color="red"><strong><code>scrollTo(x,y)</code>理解为将内容<code>(x,y)</code>的坐标移动到左上角;<br><code>scrollBy(offsetX,offsetY)</code>理解为向左移动<code>offsetX</code>个单位,向上移动<code>offsetY</code>个单位。 </strong></font>


<hr>
<h3 id="Scroller"><a href="#Scroller" class="headerlink" title="Scroller"></a>Scroller</h3><p><code>Scroller</code>通过调用<code>Scroller # startScroll(startX,startY,offsetX,offsetY,duration)</code>存储滚动数据,<code>View # invalidate()</code>重绘,在<code>onDraw()</code>中调用<code>View # computeScroll()</code>获取当前的<code>scrollX</code>,<code>scrollY</code>,使用scrollTo()完成滑动,重绘进行重复操作,直到完成整个滑动.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">//设置滚动信息</span><br><span class="line">Scroller scroller = new Scroller(getContext());</span><br><span class="line">   scroller.startScroll(startX,startY,offsetX,offsetY,duration);</span><br><span class="line">   invalidate();</span><br><span class="line"></span><br><span class="line">/* 完成滚动并重绘直到完成滑动整个过程 */</span><br><span class="line">@Override</span><br><span class="line">   public void computeScroll() &#123;</span><br><span class="line">       super.computeScroll();</span><br><span class="line">       if (scroller.computeScrollOffset())&#123;</span><br><span class="line">           scrollTo(scroller.getCurrX(),scroller.getCurrY());</span><br><span class="line">           postInvalidate();</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<hr>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://SchafferWang0818.github.io/2018/03/21/Android之自定义控件——坐标/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="SchafferWang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://b107.photo.store.qq.com/psb?/V13TTKNS3RSxL2/w9lSgrOJ.PUBfNGq5Og3KsXpTRlFWY*M0I168fsA4us!/b/dGsAAAAAAAAA&bo=VgOAAgAAAAAFB*M!&rf=viewer_4">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SchafferWang's blogs">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/21/Android之自定义控件——坐标/" itemprop="url">Android 坐标与参数/对应函数</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-21T13:35:40+08:00">
                2018-03-21
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/android-总结/" itemprop="url" rel="index">
                    <span itemprop="name">android 总结</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="View之坐标与参数-对应函数"><a href="#View之坐标与参数-对应函数" class="headerlink" title="View之坐标与参数/对应函数"></a>View之坐标与参数/对应函数</h1><hr>
<pre><code>目录:

    1. 坐标与坐标系
        - mLeft:                以父容器左上为坐标原点,左上角X值
        - mRight:                以父容器左上为坐标原点,右下角X值
        - mTop:                    以父容器左上为坐标原点,左上角Y值
        - mBottom:                以父容器左上为坐标原点,右下角Y值

        注意: offsetLeftAndRight(int offset)与offsetTopAndBottom(int offset)
        用于View的平移.直接改变以上四个值

        - translationX:            以父容器左上为坐标原点,X偏移量        
        - translationY:            以父容器左上为坐标原点,Y偏移量

        注意: 偏移量使用setTranslationX/Y(float),原相对于父容器的坐标不会发生变化,
        View通过坐标与偏移量的叠加进行绘制.

        - MotionEvent#getX():    以当前View左上为坐标原点,触摸点X值
        - MotionEvent#getY():    以当前View左上为坐标原点,触摸点Y值
        - MotionEvent#getRawX():以屏幕左上为坐标原点,触摸点X值
        - MotionEvent#getRawY():以屏幕左上为坐标原点,触摸点Y值

        注意: 与触摸事件相关.

        - mScrollX:                与View位置无关,View内容相对于原状态X方向的滚动量
        - mScrollY:                与View位置无关,View内容相对于原状态Y方向的滚动量

        注意: 向上/左,滚动量为正;反之为负.

        - mPaddingLeft
        - mPaddingRight
        - mPaddingTop
        - mPaddingBottom



    2. 参数与函数
        - width:                       getRight() - getLeft()
        - height:                      getBottom() - getTop()
        - measureWidth:                mMeasuredWidth &amp; MEASURED_SIZE_MASK
        - measureHeight:               mMeasuredHeight &amp; MEASURED_SIZE_MASK

        注: &gt;&gt;&gt; width/height 与 measureWidth/measureHeight 区别在于赋值时机不同,
            &gt;&gt;&gt; measureWidth/measureHeight 形成于 measure 过程;
            &gt;&gt;&gt; width/height 形成于 layout 过程;

        - getLocalVisibleRect(Rect)
        - getGlobalVisibleRect(Rect,Point)
        - getLocationOnScreen(int[2])
        - getLocationInWindow(int[2])
</code></pre><hr>
<h3 id="坐标与坐标系"><a href="#坐标与坐标系" class="headerlink" title="坐标与坐标系"></a>坐标与坐标系</h3><ol>
<li><p>坐标示意图如下:</p>
<p> <img src="http://upload-images.jianshu.io/upload_images/3551332-ceab93bf82f135a8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="坐标示意图"></p>
</li>
<li><p>角度示意图如下:</p>
<p> <img src="http://upload-images.jianshu.io/upload_images/3846387-89827b3403db8137.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="角度坐标"></p>
</li>
<li><p>滚动量值示意图如下:</p>
<p> <img src="http://upload-images.jianshu.io/upload_images/1302497-a65d8640ea8029cb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="滚动量值"></p>
</li>
</ol>
<hr>
<h3 id="参数与函数"><a href="#参数与函数" class="headerlink" title="参数与函数"></a>参数与函数</h3><h4 id="1-获得View相对于父容器-屏幕原点的偏移量"><a href="#1-获得View相对于父容器-屏幕原点的偏移量" class="headerlink" title="1. 获得View相对于父容器/屏幕原点的偏移量"></a>1. 获得View相对于父容器/屏幕原点的偏移量</h4><pre><code>来源链接：http://www.jianshu.com/p/f09541b2f43b
</code></pre><ul>
<li><p><code>getLocalVisibleRect(Rect)</code>: 获取View在其父控件中的可见区域相对于此View的左顶点的距离（偏移量）；</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Rect localRect = new Rect();</span><br><span class="line">      v.getLocalVisibleRect(localRect);</span><br><span class="line">      ((TextView) findViewById(R.id.local)).setText(&quot;local&quot; + localRect.toString());</span><br><span class="line">//显示左上和右下两个点的相对坐标</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>getGlobalVisibleRect(Rect,Point)</code>: 获取View在其父控件中的可见区域相对于屏幕左顶点的距离（偏移量）；</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Rect globalRect = new Rect();</span><br><span class="line">      Point globalOffset = new Point();</span><br><span class="line">      v.getGlobalVisibleRect(globalRect, globalOffset);</span><br><span class="line">      ((TextView) findViewById(R.id.global)).setText(&quot;global&quot; + globalRect.toString());</span><br><span class="line">      ((TextView) findViewById(R.id.offset)).setText(&quot;globalOffset:&quot; + globalOffset.x + &quot;,&quot; + globalOffset.y);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="2-绝对坐标"><a href="#2-绝对坐标" class="headerlink" title="2. 绝对坐标"></a>2. 绝对坐标</h4><pre><code>来源链接：http://www.jianshu.com/p/665449c78c74
</code></pre><ul>
<li><p><code>getLocationOnScreen(int[2])</code>：计算该视图在Android坐标系中的x，y值，获取在当前屏幕内的绝对坐标（这个值是要从屏幕顶端算起，当然包括了通知栏和状态栏的高度）</p>
</li>
<li><p><code>getLocationInWindow(int[2])</code>: 计算该视图在它所在的window的坐标x，y值，获取在整个window的绝对坐标</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">例如:</span><br><span class="line"></span><br><span class="line">    int[] location = new int[2];</span><br><span class="line">    view.getLocationOnScreen(location);</span><br><span class="line">    int x = location[0];</span><br><span class="line">    int y = location[1];</span><br></pre></td></tr></table></figure>
<hr>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://SchafferWang0818.github.io/2018/03/21/Android之自定义控件——事件分发,拦截,处理/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="SchafferWang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://b107.photo.store.qq.com/psb?/V13TTKNS3RSxL2/w9lSgrOJ.PUBfNGq5Og3KsXpTRlFWY*M0I168fsA4us!/b/dGsAAAAAAAAA&bo=VgOAAgAAAAAFB*M!&rf=viewer_4">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SchafferWang's blogs">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/21/Android之自定义控件——事件分发,拦截,处理/" itemprop="url">Android 事件分发机制表现与实现原理</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-21T13:35:40+08:00">
                2018-03-21
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/android-总结/" itemprop="url" rel="index">
                    <span itemprop="name">android 总结</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="事件分发机制表现与实现原理"><a href="#事件分发机制表现与实现原理" class="headerlink" title="事件分发机制表现与实现原理"></a>事件分发机制表现与实现原理</h1><pre><code>http://blog.csdn.net/qq_23547831/article/details/51530671
表现图片来源: http://blog.csdn.net/chunqiuwei/article/details/41084921
</code></pre><ul>
<li><p>事件拦截表现<br><img src="http://img.blog.csdn.net/20141113191428406?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvY2h1bnFpdXdlaQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="事件拦截1"></p>
<ul>
<li>不拦截不处理时<br><img src="http://img.blog.csdn.net/20141113192118648?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvY2h1bnFpdXdlaQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="事件拦截2"></li>
<li>C拦截但不处理时<br><img src="http://img.blog.csdn.net/20141113193108593?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvY2h1bnFpdXdlaQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="事件拦截3"></li>
<li>D处理时<br><img src="http://img.blog.csdn.net/20141113193349703?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvY2h1bnFpdXdlaQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast" alt="事件拦截4"></li>
</ul>
</li>
<li><p>事件拦截原理<br><img src="https://i.imgur.com/S49ezlo.png" alt="Android 事件分发机制"></p>
</li>
</ul>
<h3 id="ViewGroup-dispatchTouchEvent"><a href="#ViewGroup-dispatchTouchEvent" class="headerlink" title="ViewGroup # dispatchTouchEvent()"></a><code>ViewGroup # dispatchTouchEvent()</code></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">// Handle an initial down.</span><br><span class="line">         if (actionMasked == MotionEvent.ACTION_DOWN) &#123;</span><br><span class="line">             // Throw away all previous state when starting a new touch gesture.</span><br><span class="line">             // The framework may have dropped the up or cancel event for the previous gesture</span><br><span class="line">             // due to an app switch, ANR, or some other state change.</span><br><span class="line">             cancelAndClearTouchTargets(ev);//清除之前的所有其他动作,使mFirstTouchTarget=null</span><br><span class="line">             resetTouchState();//重置Touch状态标识。</span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">// Check for interception.</span><br><span class="line">         final boolean intercepted;</span><br><span class="line">         if (actionMasked == MotionEvent.ACTION_DOWN</span><br><span class="line">                 || mFirstTouchTarget != null) &#123;</span><br><span class="line">             final boolean disallowIntercept = (mGroupFlags &amp; FLAG_DISALLOW_INTERCEPT) != 0;</span><br><span class="line">             if (!disallowIntercept) &#123;</span><br><span class="line">                 intercepted = onInterceptTouchEvent(ev);//默认不拦截</span><br><span class="line">                 ev.setAction(action); // restore action in case it was changed</span><br><span class="line">             &#125; else &#123;</span><br><span class="line">                 intercepted = false;</span><br><span class="line">             &#125;</span><br><span class="line">         &#125; else &#123;</span><br><span class="line">             // There are no touch targets and this action is not an initial down</span><br><span class="line">             // so this view group continues to intercept touches.</span><br><span class="line">             intercepted = true;</span><br><span class="line">         &#125;</span><br></pre></td></tr></table></figure>
<ol>
<li>每个<code>MotionEvent.ACTION_DOWN</code>发生时会清除之前所有连续的动作并作为一系列动作的开端；</li>
<li>当<code>MotionEvent.ACTION_DOWN</code>或存在动作接收对象时,默认不拦截动作；否则拦截动作；</li>
</ol>
<hr>
<h3 id="View-dispatchTouchEvent-event"><a href="#View-dispatchTouchEvent-event" class="headerlink" title="View # dispatchTouchEvent(event)"></a><code>View # dispatchTouchEvent(event)</code></h3><p><code>ViewGroup # dispatchTouchEvent(event)</code> <strong>倒序循环判断当前从上方到下方的<code>直接子View/ViewGroup</code></strong>, 判断当前事件是否存在消费对象,<strong>递归判断</strong>,最终调用的是已经定义过的<code>child # dispatchTouchEvent()</code>或者是<code>View # dispatchTouchEvent(event)</code></p>
<ul>
<li><code>View # dispatchTouchEvent(event)</code> 返回<code>true</code>的情况<ul>
<li>处理内部滚动事件</li>
<li><code>View # isEnabled()==true</code>,添加<code>View $ OnTouchListener</code>并在<code>OnTouchListener # onTouch()</code>返回true;</li>
<li><code>View # onTouchEvent()</code>返回true;</li>
</ul>
</li>
</ul>
<p>如果控件（View）是enable且onTouch返回true情况下，dispatchTouchEvent直接返回true，不会调用onTouchEvent方法。</p>
<p>完整代码如下:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    * View # dispatchTouchEvent(event)</span></span><br><span class="line"><span class="comment">    * </span></span><br><span class="line"><span class="comment">    * Pass the touch screen motion event down to the target view, or this</span></span><br><span class="line"><span class="comment">    * view if it is the target.</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> event The motion event to be dispatched.</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span> True if the event was handled by the view, false otherwise.</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">dispatchTouchEvent</span><span class="params">(MotionEvent event)</span> </span>&#123;</span><br><span class="line">       <span class="comment">// If the event should be handled by accessibility focus first.</span></span><br><span class="line">       <span class="keyword">if</span> (event.isTargetAccessibilityFocus()) &#123;</span><br><span class="line">           <span class="comment">// We don't have focus or no virtual descendant has it, do not handle the event.</span></span><br><span class="line">           <span class="keyword">if</span> (!isAccessibilityFocusedViewOrHost()) &#123;</span><br><span class="line">               <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="comment">// We have focus and got the event, then use normal event dispatch.</span></span><br><span class="line">           event.setTargetAccessibilityFocus(<span class="keyword">false</span>);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">boolean</span> result = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span> (mInputEventConsistencyVerifier != <span class="keyword">null</span>) &#123;</span><br><span class="line">           mInputEventConsistencyVerifier.onTouchEvent(event, <span class="number">0</span>);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">final</span> <span class="keyword">int</span> actionMasked = event.getActionMasked();</span><br><span class="line">       <span class="keyword">if</span> (actionMasked == MotionEvent.ACTION_DOWN) &#123;</span><br><span class="line">           <span class="comment">// Defensive cleanup for new gesture</span></span><br><span class="line">           stopNestedScroll();</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span> (onFilterTouchEventForSecurity(event)) &#123;</span><br><span class="line">           <span class="keyword">if</span> ((mViewFlags &amp; ENABLED_MASK) == ENABLED &amp;&amp; handleScrollBarDragging(event)) &#123;</span><br><span class="line">               result = <span class="keyword">true</span>;</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="comment">//noinspection SimplifiableIfStatement</span></span><br><span class="line">           ListenerInfo li = mListenerInfo;</span><br><span class="line">           <span class="keyword">if</span> (li != <span class="keyword">null</span> &amp;&amp; li.mOnTouchListener != <span class="keyword">null</span></span><br><span class="line">                   &amp;&amp; (mViewFlags &amp; ENABLED_MASK) == ENABLED</span><br><span class="line">                   &amp;&amp; li.mOnTouchListener.onTouch(<span class="keyword">this</span>, event)) &#123;</span><br><span class="line">               result = <span class="keyword">true</span>;</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           <span class="keyword">if</span> (!result &amp;&amp; onTouchEvent(event)) &#123;</span><br><span class="line">               result = <span class="keyword">true</span>;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">if</span> (!result &amp;&amp; mInputEventConsistencyVerifier != <span class="keyword">null</span>) &#123;</span><br><span class="line">           mInputEventConsistencyVerifier.onUnhandledEvent(event, <span class="number">0</span>);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// Clean up after nested scrolls if this is the end of a gesture;</span></span><br><span class="line">       <span class="comment">// also cancel it if we tried an ACTION_DOWN but we didn't want the rest</span></span><br><span class="line">       <span class="comment">// of the gesture.</span></span><br><span class="line">       <span class="keyword">if</span> (actionMasked == MotionEvent.ACTION_UP ||</span><br><span class="line">               actionMasked == MotionEvent.ACTION_CANCEL ||</span><br><span class="line">               (actionMasked == MotionEvent.ACTION_DOWN &amp;&amp; !result)) &#123;</span><br><span class="line">           stopNestedScroll();</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">return</span> result;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="View-onTouchEvent-event"><a href="#View-onTouchEvent-event" class="headerlink" title="View # onTouchEvent(event)"></a><code>View # onTouchEvent(event)</code></h3><ul>
<li>点击和长按事件都会消耗当前事件返回true</li>
</ul>
<p>全部代码如下:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Implement this method to handle touch screen motion events.</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * If this method is used to detect click actions, it is recommended that</span></span><br><span class="line"><span class="comment"> * the actions be performed by implementing and calling</span></span><br><span class="line"><span class="comment"> * &#123;<span class="doctag">@link</span> #performClick()&#125;. This will ensure consistent system behavior,</span></span><br><span class="line"><span class="comment"> * including:</span></span><br><span class="line"><span class="comment"> * &lt;ul&gt;</span></span><br><span class="line"><span class="comment"> * &lt;li&gt;obeying click sound preferences</span></span><br><span class="line"><span class="comment"> * &lt;li&gt;dispatching OnClickListener calls</span></span><br><span class="line"><span class="comment"> * &lt;li&gt;handling &#123;<span class="doctag">@link</span> AccessibilityNodeInfo#ACTION_CLICK ACTION_CLICK&#125; when</span></span><br><span class="line"><span class="comment"> * accessibility features are enabled</span></span><br><span class="line"><span class="comment"> * &lt;/ul&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> event The motion event.</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> True if the event was handled, false otherwise.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onTouchEvent</span><span class="params">(MotionEvent event)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">float</span> x = event.getX();</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">float</span> y = event.getY();</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> viewFlags = mViewFlags;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">int</span> action = event.getAction();</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt;    <span class="keyword">final</span> <span class="keyword">boolean</span> clickable = ((viewFlags &amp; CLICKABLE) == CLICKABLE</span><br><span class="line">            || (viewFlags &amp; LONG_CLICKABLE) == LONG_CLICKABLE)</span><br><span class="line">            || (viewFlags &amp; CONTEXT_CLICKABLE) == CONTEXT_CLICKABLE;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ((viewFlags &amp; ENABLED_MASK) == DISABLED) &#123;</span><br><span class="line">        <span class="keyword">if</span> (action == MotionEvent.ACTION_UP &amp;&amp; (mPrivateFlags &amp; PFLAG_PRESSED) != <span class="number">0</span>) &#123;</span><br><span class="line">            setPressed(<span class="keyword">false</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        mPrivateFlags3 &amp;= ~PFLAG3_FINGER_DOWN;</span><br><span class="line">        <span class="comment">// A disabled view that is clickable still consumes the touch</span></span><br><span class="line">        <span class="comment">// events, it just doesn't respond to them.</span></span><br><span class="line">&gt;&gt;&gt;     <span class="keyword">return</span> clickable;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (mTouchDelegate != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (mTouchDelegate.onTouchEvent(event)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (clickable || (viewFlags &amp; TOOLTIP) == TOOLTIP) &#123;</span><br><span class="line">        <span class="keyword">switch</span> (action) &#123;</span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_UP:</span><br><span class="line">                mPrivateFlags3 &amp;= ~PFLAG3_FINGER_DOWN;</span><br><span class="line">                <span class="keyword">if</span> ((viewFlags &amp; TOOLTIP) == TOOLTIP) &#123;</span><br><span class="line">                    handleTooltipUp();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (!clickable) &#123;</span><br><span class="line">                    removeTapCallback();</span><br><span class="line">                    removeLongPressCallback();</span><br><span class="line">                    mInContextButtonPress = <span class="keyword">false</span>;</span><br><span class="line">                    mHasPerformedLongPress = <span class="keyword">false</span>;</span><br><span class="line">                    mIgnoreNextUpEvent = <span class="keyword">false</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">boolean</span> prepressed = (mPrivateFlags &amp; PFLAG_PREPRESSED) != <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">if</span> ((mPrivateFlags &amp; PFLAG_PRESSED) != <span class="number">0</span> || prepressed) &#123;</span><br><span class="line">                    <span class="comment">// take focus if we don't have it already and we should in</span></span><br><span class="line">                    <span class="comment">// touch mode.</span></span><br><span class="line">                    <span class="keyword">boolean</span> focusTaken = <span class="keyword">false</span>;</span><br><span class="line">                    <span class="keyword">if</span> (isFocusable() &amp;&amp; isFocusableInTouchMode() &amp;&amp; !isFocused()) &#123;</span><br><span class="line">                        focusTaken = requestFocus();</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (prepressed) &#123;</span><br><span class="line">                        <span class="comment">// The button is being released before we actually</span></span><br><span class="line">                        <span class="comment">// showed it as pressed.  Make it show the pressed</span></span><br><span class="line">                        <span class="comment">// state now (before scheduling the click) to ensure</span></span><br><span class="line">                        <span class="comment">// the user sees it.</span></span><br><span class="line">                        setPressed(<span class="keyword">true</span>, x, y);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (!mHasPerformedLongPress &amp;&amp; !mIgnoreNextUpEvent) &#123;</span><br><span class="line">                        <span class="comment">// This is a tap, so remove the longpress check</span></span><br><span class="line">                        removeLongPressCallback();</span><br><span class="line"></span><br><span class="line">                        <span class="comment">// Only perform take click actions if we were in the pressed state</span></span><br><span class="line">                        <span class="keyword">if</span> (!focusTaken) &#123;</span><br><span class="line">                            <span class="comment">// Use a Runnable and post this rather than calling</span></span><br><span class="line">                            <span class="comment">// performClick directly. This lets other visual state</span></span><br><span class="line">                            <span class="comment">// of the view update before click actions start.</span></span><br><span class="line">                            <span class="keyword">if</span> (mPerformClick == <span class="keyword">null</span>) &#123;</span><br><span class="line">                                mPerformClick = <span class="keyword">new</span> PerformClick();</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">if</span> (!post(mPerformClick)) &#123;</span><br><span class="line">                                performClick();</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (mUnsetPressedState == <span class="keyword">null</span>) &#123;</span><br><span class="line">                        mUnsetPressedState = <span class="keyword">new</span> UnsetPressedState();</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> (prepressed) &#123;</span><br><span class="line">                        postDelayed(mUnsetPressedState,</span><br><span class="line">                                ViewConfiguration.getPressedStateDuration());</span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!post(mUnsetPressedState)) &#123;</span><br><span class="line">                        <span class="comment">// If the post failed, unpress right now</span></span><br><span class="line">                        mUnsetPressedState.run();</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    removeTapCallback();</span><br><span class="line">                &#125;</span><br><span class="line">                mIgnoreNextUpEvent = <span class="keyword">false</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_DOWN:</span><br><span class="line">                <span class="keyword">if</span> (event.getSource() == InputDevice.SOURCE_TOUCHSCREEN) &#123;</span><br><span class="line">                    mPrivateFlags3 |= PFLAG3_FINGER_DOWN;</span><br><span class="line">                &#125;</span><br><span class="line">                mHasPerformedLongPress = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (!clickable) &#123;</span><br><span class="line">                    checkForLongClick(<span class="number">0</span>, x, y);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (performButtonActionOnTouchDown(event)) &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// Walk up the hierarchy to determine if we're inside a scrolling container.</span></span><br><span class="line">                <span class="keyword">boolean</span> isInScrollingContainer = isInScrollingContainer();</span><br><span class="line"></span><br><span class="line">                <span class="comment">// For views inside a scrolling container, delay the pressed feedback for</span></span><br><span class="line">                <span class="comment">// a short period in case this is a scroll.</span></span><br><span class="line">                <span class="keyword">if</span> (isInScrollingContainer) &#123;</span><br><span class="line">                    mPrivateFlags |= PFLAG_PREPRESSED;</span><br><span class="line">                    <span class="keyword">if</span> (mPendingCheckForTap == <span class="keyword">null</span>) &#123;</span><br><span class="line">                        mPendingCheckForTap = <span class="keyword">new</span> CheckForTap();</span><br><span class="line">                    &#125;</span><br><span class="line">                    mPendingCheckForTap.x = event.getX();</span><br><span class="line">                    mPendingCheckForTap.y = event.getY();</span><br><span class="line">                    postDelayed(mPendingCheckForTap, ViewConfiguration.getTapTimeout());</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="comment">// Not inside a scrolling container, so show the feedback right away</span></span><br><span class="line">                    setPressed(<span class="keyword">true</span>, x, y);</span><br><span class="line">                    checkForLongClick(<span class="number">0</span>, x, y);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_CANCEL:</span><br><span class="line">                <span class="keyword">if</span> (clickable) &#123;</span><br><span class="line">                    setPressed(<span class="keyword">false</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                removeTapCallback();</span><br><span class="line">                removeLongPressCallback();</span><br><span class="line">                mInContextButtonPress = <span class="keyword">false</span>;</span><br><span class="line">                mHasPerformedLongPress = <span class="keyword">false</span>;</span><br><span class="line">                mIgnoreNextUpEvent = <span class="keyword">false</span>;</span><br><span class="line">                mPrivateFlags3 &amp;= ~PFLAG3_FINGER_DOWN;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> MotionEvent.ACTION_MOVE:</span><br><span class="line">                <span class="keyword">if</span> (clickable) &#123;</span><br><span class="line">                    drawableHotspotChanged(x, y);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// Be lenient about moving outside of buttons</span></span><br><span class="line">                <span class="keyword">if</span> (!pointInView(x, y, mTouchSlop)) &#123;</span><br><span class="line">                    <span class="comment">// Outside button</span></span><br><span class="line">                    <span class="comment">// Remove any future long press/tap checks</span></span><br><span class="line">                    removeTapCallback();</span><br><span class="line">                    removeLongPressCallback();</span><br><span class="line">                    <span class="keyword">if</span> ((mPrivateFlags &amp; PFLAG_PRESSED) != <span class="number">0</span>) &#123;</span><br><span class="line">                        setPressed(<span class="keyword">false</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    mPrivateFlags3 &amp;= ~PFLAG3_FINGER_DOWN;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<hr>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://SchafferWang0818.github.io/2018/03/21/Android之自定义控件——事件之MotionEvent/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="SchafferWang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://b107.photo.store.qq.com/psb?/V13TTKNS3RSxL2/w9lSgrOJ.PUBfNGq5Og3KsXpTRlFWY*M0I168fsA4us!/b/dGsAAAAAAAAA&bo=VgOAAgAAAAAFB*M!&rf=viewer_4">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SchafferWang's blogs">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/21/Android之自定义控件——事件之MotionEvent/" itemprop="url">Android MotionEvent</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-21T13:35:40+08:00">
                2018-03-21
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/android-总结/" itemprop="url" rel="index">
                    <span itemprop="name">android 总结</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="MotionEvent"><a href="#MotionEvent" class="headerlink" title="MotionEvent"></a>MotionEvent</h1><pre><code>1. 不常用事件;
2. 多点触控事件;
3. 历史数据(事件批处理);
4. 获取事件发生的时间;
5. 获取压力(接触面积大小);
6. 鼠标事件;
参考自: http://www.gcssloop.com/customview/motionevent
</code></pre><hr>
<table>
<thead>
<tr>
<th>事件</th>
<th>简介</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ACTION_DOWN</code></td>
<td>手指 初次接触到屏幕 时触发。</td>
</tr>
<tr>
<td><code>ACTION_MOVE</code></td>
<td>手指 在屏幕上滑动 时触发，会多次触发。</td>
</tr>
<tr>
<td><code>ACTION_UP</code></td>
<td>手指 离开屏幕 时触发。</td>
</tr>
<tr>
<td><code>ACTION_CANCEL</code></td>
<td>事件 <strong>被上层拦截</strong> 时触发。</td>
</tr>
<tr>
<td><code>ACTION_OUTSIDE</code></td>
<td>手指 <strong>不在控件区域</strong> 时触发。</td>
</tr>
<tr>
<td><code>ACTION_POINTER_DOWN</code></td>
<td>有<strong>非主要</strong>的手指<strong>按下</strong>(即按下之前已经有手指在屏幕上)。</td>
</tr>
<tr>
<td><code>ACTION_POINTER_UP</code></td>
<td>有<strong>非主要</strong>的手指<strong>抬起</strong>(即抬起之后仍然有手指在屏幕上)。</td>
</tr>
</tbody>
</table>
<h3 id="不常用事件之ACTION-CANCEL"><a href="#不常用事件之ACTION-CANCEL" class="headerlink" title="不常用事件之ACTION_CANCEL"></a>不常用事件之<code>ACTION_CANCEL</code></h3><p><strong>父容器在判断了事件之后对事件处理权的收回,<code>childView</code>收到<code>ACTION_CANCEL</code>不会收到后续事件。</strong></p>
<blockquote>
<p><code>RecyclerView</code>：儿砸，这里有一个 <code>ACTION_DOWN</code> 你看你要不要。<br><code>ItemView</code> ：好嘞，我看看。<br><code>RecyclerView</code>：噫？居然是移动事件 <code>ACTION_MOVE</code>，我要滚起来了，儿砸，我可能要把你送去你姑父家(缓存区)了，在这之前给你一个 <code>ACTION_CANCEL</code>，你要收好啊。<br><code>ItemView</code> ：……</p>
</blockquote>
<hr>
<h3 id="不常用事件之ACTION-OUTSIDE"><a href="#不常用事件之ACTION-OUTSIDE" class="headerlink" title="不常用事件之ACTION_OUTSIDE"></a>不常用事件之<code>ACTION_OUTSIDE</code></h3><p>视图所在的<code>WindowManager</code>设置了<code>FLAG_WATCH_OUTSIDE_TOUCH</code>的<code>flag</code>后才能收到的动作。</p>
<hr>
<h3 id="多点触控"><a href="#多点触控" class="headerlink" title="多点触控"></a>多点触控</h3><p><strong>通过多点编号完成指针判断。第一次按下的手指特殊处理作为主指针，之后按下的手指作为辅助指针。</strong></p>
<table>
<thead>
<tr>
<th>方法</th>
<th>简介</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ev.getActionMasked()</code></td>
<td>与 <code>getAction()</code> 类似，<strong>多点触控必须使用这个方法获取事件类型</strong>。</td>
</tr>
<tr>
<td><del><code>ev.getActionIndex()</code></del></td>
<td><del>获取该事件是哪个指针(手指)产生的。</del></td>
</tr>
<tr>
<td><code>ev.getPointerCount()</code></td>
<td>获取在屏幕上手指的个数。</td>
</tr>
<tr>
<td><code>ev.getPointerId(int pointerIndex)</code></td>
<td>获取一个指针(手指)的唯一标识符ID，在手指按下和抬起之间ID始终不变。</td>
</tr>
<tr>
<td><code>ev.findPointerIndex(int pointerId)</code></td>
<td>通过<code>PointerId</code>获取到当前状态下<code>PointIndex</code>，之后通过<code>PointIndex</code>获取其他内容。</td>
</tr>
<tr>
<td><code>ev.getX(int pointerIndex )</code></td>
<td>获取某一个指针(手指)的X坐标</td>
</tr>
<tr>
<td><code>ev.getY(int pointerIndex )</code></td>
<td>获取某一个指针(手指)的Y坐标</td>
</tr>
</tbody>
</table>
<blockquote>
<p>当多个手指在屏幕上按下的时候，会产生大量的事件，如何在获取事件类型的同时区分这些事件就是一个大问题了。一般来说我们可以通过为事件添加一个int类型的index属性来区分，但是谷歌工程师是有洁癖的，<font color="blue"><strong>为了添加一个通常数值不会超过10的index属性就浪费一个int大小的空间简直是不能忍受的</strong></font>，于是工程师们将这个index属性和事件类型直接合并了。int类型共32位(0x00000000)，他们用最低8位(0x000000<strong>ff</strong>)表示事件类型，再往前的8位(0x0000<strong>ff</strong>00)表示事件编号。</p>
</blockquote>
<table>
<thead>
<tr>
<th>手指按下</th>
<th>触发事件(数值)</th>
</tr>
</thead>
<tbody>
<tr>
<td>第1个手指按下</td>
<td><code>ACTION_DOWN</code> (0x0000<strong>00</strong>00)</td>
</tr>
<tr>
<td>—</td>
<td><code>ACTION_POINTER_DOWN</code>(0x0000<strong>00</strong>05)</td>
</tr>
<tr>
<td>第2个手指按下</td>
<td><code>ACTION_POINTER_2_DOWN</code> (0x0000<strong>01</strong>05)</td>
</tr>
<tr>
<td>第3个手指按下</td>
<td><code>ACTION_POINTER_3_DOWN</code> (0x0000<strong>02</strong>05)</td>
</tr>
<tr>
<td>第4个手指按下</td>
<td><code>ACTION_POINTER_4_DOWN</code> (0x0000<strong>03</strong>05)</td>
</tr>
</tbody>
</table>
<blockquote>
<p>注意：<br>上面表格中用粗体标示出的数值，可以看到随着按下手指数量的增加，这个数值也是一直变化的，进而导致我们使用 <code>getAction()</code> 获取到的数值无法与标准的事件类型进行对比，为了解决这个问题，他们创建了一个 <code>getActionMasked()</code> 方法，这个方法可以清除index数值，让其变成一个标准的事件类型。<br><strong><font color="black"> 1、多点触控时必须使用 <code>getActionMasked()</code> 来获取事件类型。<br>2、单点触控时由于事件数值不变，使用 <code>getAction()</code> 和 <code>getActionMasked()</code> 两个方法都可以。<br>3、使用 <code>getActionIndex()</code> 可以获取到这个index数值。不过请注意，<code>getActionIndex()</code> 只在 down 和 up 时有效，move 时是无效的。</font></strong></p>
</blockquote>
<blockquote>
<p>目前来说获取事件类型使用 <code>getActionMasked()</code> 就行了，但是如果一定要编译时兼容古董版本的话，可以考虑使用这样的写法:</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="keyword">int</span> action = (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.FROYO)</span><br><span class="line">                ? event.getActionMasked()</span><br><span class="line">                : event.getAction();</span><br><span class="line"><span class="keyword">switch</span> (action)&#123;</span><br><span class="line">    <span class="keyword">case</span> MotionEvent.ACTION_DOWN:</span><br><span class="line">        <span class="comment">// TODO</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="历史数据-事件批处理"><a href="#历史数据-事件批处理" class="headerlink" title="历史数据(事件批处理)"></a>历史数据(事件批处理)</h3><p>由于我们的设备非常灵敏，手指稍微移动一下就会产生一个移动事件，所以移动事件会产生的特别频繁，为了提高效率，<font color="red"><strong>系统会将近期的多个移动事件(move)按照事件发生的顺序进行排序打包放在同一个 MotionEvent 中</strong></font>，与之对应的产生了以下方法：</p>
<table>
<thead>
<tr>
<th>事件</th>
<th>简介</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ev.getHistorySize()</code></td>
<td>获取历史事件集合大小</td>
</tr>
<tr>
<td><code>ev.getHistoricalX(int pos)</code></td>
<td>获取第pos个历史事件x坐标 <br><code>(pos &lt; getHistorySize())</code></td>
</tr>
<tr>
<td><code>ev.getHistoricalY(int pos)</code></td>
<td>获取第pos个历史事件y坐标 <br><code>(pos &lt; getHistorySize())</code></td>
</tr>
<tr>
<td><code>ev.getHistoricalX (int pin, int pos)</code></td>
<td>获取第pin个手指的第pos个历史事件x坐标 <br><code>(pin &lt; getPointerCount(), pos &lt; getHistorySize() )</code></td>
</tr>
<tr>
<td><code>ev.getHistoricalY (int pin, int pos)</code></td>
<td>获取第pin个手指的第pos个历史事件y坐标 <br><code>(pin &lt; getPointerCount(), pos &lt; getHistorySize() )</code></td>
</tr>
</tbody>
</table>
<p>注意：</p>
<ul>
<li>pin 全称是 <code>pointerIndex</code>，表示第几个手指，此处为了节省空间使用了缩写。</li>
<li><font color="red"> 历史数据只有 <code>ACTION_MOVE</code> 事件。</font></li>
<li>历史数据单点触控和多点触控均可以用。</li>
</ul>
<p>下面是官方文档给出的一个简单使用示例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printSamples</span><span class="params">(MotionEvent ev)</span> </span>&#123;</span><br><span class="line">     <span class="keyword">final</span> <span class="keyword">int</span> historySize = ev.getHistorySize();</span><br><span class="line">     <span class="keyword">final</span> <span class="keyword">int</span> pointerCount = ev.getPointerCount();</span><br><span class="line">     <span class="keyword">for</span> (<span class="keyword">int</span> h = <span class="number">0</span>; h &lt; historySize; h++) &#123;</span><br><span class="line">         System.out.printf(<span class="string">"At time %d:"</span>, ev.getHistoricalEventTime(h));</span><br><span class="line">         <span class="keyword">for</span> (<span class="keyword">int</span> p = <span class="number">0</span>; p &lt; pointerCount; p++) &#123;</span><br><span class="line">             System.out.printf(<span class="string">"  pointer %d: (%f,%f)"</span>,</span><br><span class="line">                 ev.getPointerId(p), ev.getHistoricalX(p, h), ev.getHistoricalY(p, h));</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br><span class="line">     System.out.printf(<span class="string">"At time %d:"</span>, ev.getEventTime());</span><br><span class="line">     <span class="keyword">for</span> (<span class="keyword">int</span> p = <span class="number">0</span>; p &lt; pointerCount; p++) &#123;</span><br><span class="line">         System.out.printf(<span class="string">"  pointer %d: (%f,%f)"</span>,</span><br><span class="line">             ev.getPointerId(p), ev.getX(p), ev.getY(p));</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="获取事件发生的时间"><a href="#获取事件发生的时间" class="headerlink" title="获取事件发生的时间"></a>获取事件发生的时间</h3><table>
<thead>
<tr>
<th>方法</th>
<th>简介</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>getDownTime()</code></td>
<td>获取手指按下时的时间。</td>
</tr>
<tr>
<td><code>getEventTime()</code></td>
<td>获取当前事件发生的时间。</td>
</tr>
<tr>
<td><code>getHistoricalEventTime(int pos)</code></td>
<td>获取历史事件发生的时间。</td>
</tr>
</tbody>
</table>
<blockquote>
<p>pos 表示历史数据中的第几个数据。( pos &lt; getHistorySize() )<br>返回值类型为 long，单位是毫秒。</p>
</blockquote>
<hr>
<h3 id="获取压力-接触面积大小"><a href="#获取压力-接触面积大小" class="headerlink" title="获取压力(接触面积大小)"></a>获取压力(接触面积大小)</h3><p>MotionEvent支持获取某些输入设备(手指或触控笔)的与屏幕的接触面积和压力大小，主要有以下方法：</p>
<blockquote>
<p>描述中使用了手指，触控笔也是一样的。</p>
</blockquote>
<table>
<thead>
<tr>
<th>方法</th>
<th>简介</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>getSize ()</code></td>
<td>获取第1个手指与屏幕接触面积的大小</td>
</tr>
<tr>
<td><code>getSize (int pin)</code></td>
<td>获取第pin个手指与屏幕接触面积的大小</td>
</tr>
<tr>
<td><code>getHistoricalSize (int pos)</code></td>
<td>获取历史数据中第1个手指在第pos次事件中的接触面积</td>
</tr>
<tr>
<td><code>getHistoricalSize (int pin, int pos)</code></td>
<td>获取历史数据中第pin个手指在第pos次事件中的接触面积</td>
</tr>
<tr>
<td><code>getPressure ()</code></td>
<td>获取第一个手指的压力大小</td>
</tr>
<tr>
<td><code>getPressure (int pin)</code></td>
<td>获取第pin个手指的压力大小</td>
</tr>
<tr>
<td><code>getHistoricalPressure (int pos)</code></td>
<td>获取历史数据中第1个手指在第pos次事件中的压力大小</td>
</tr>
<tr>
<td><code>getHistoricalPressure (int pin, int pos)</code></td>
<td>获取历史数据中第pin个手指在第pos次事件中的压力大小</td>
</tr>
</tbody>
</table>
<blockquote>
<p>pin 全称是 pointerIndex，表示第几个手指。<code>(pin &lt; getPointerCount() )</code><br>pos 表示历史数据中的第几个数据。<code>( pos &lt; getHistorySize() )</code></p>
</blockquote>
<p>注意：</p>
<ol>
<li>获取接触面积大小和获取压力大小是需要硬件支持的。</li>
<li>非常不幸的是<font color="red"><strong>大部分设备所使用的电容屏不支持压力检测</strong></font>，但能够大致检测出接触面积。</li>
<li><font color="red">大部分设备的 <code>getPressure()</code> 是使用接触面积来模拟的</font>。</li>
<li>由于某些未知的原因(可能系统版本和硬件问题)，某些设备不支持 <code>getPressure()</code>。</li>
<li>系统问题造成<font color="blue"><strong>有的设备上只有<code>getSize()</code>能用，有的设备上只有 <code>getPressure()</code> 能用，而有的则两个都不能用</strong></font>。</li>
</ol>
<p>由于获取接触面积和获取压力大小受系统和硬件影响，使用的时候一定要进行数据检测，以防因为设备问题而导致程序出错。</p>
<hr>
<h3 id="鼠标事件"><a href="#鼠标事件" class="headerlink" title="鼠标事件"></a>鼠标事件</h3><p>由于触控笔事件和手指事件处理流程大致相同，与鼠标相关的几个事件：</p>
<table>
<thead>
<tr>
<th>事件</th>
<th>简介</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ACTION_HOVER_ENTER</code></td>
<td>指针移入到窗口或者View区域，但没有按下。</td>
</tr>
<tr>
<td><code>ACTION_HOVER_MOVE</code></td>
<td>指针在窗口或者View区域移动，但没有按下。</td>
</tr>
<tr>
<td><code>ACTION_HOVER_EXIT</code></td>
<td>指针移出到窗口或者View区域，但没有按下。</td>
</tr>
<tr>
<td><code>ACTION_SCROLL</code></td>
<td>滚轮滚动，可以触发水平滚动(<code>AXIS_HSCROLL</code>)或者垂直滚动(<code>AXIS_VSCROLL</code>)</td>
</tr>
</tbody>
</table>
<p>注意：</p>
<ol>
<li>这些事件类型是 安卓4.0 (API 14) 才添加的。</li>
<li>使用 <code>getActionMasked()</code> 获得这些事件类型。</li>
<li>这些事件不会传递到 <code>onTouchEvent(MotionEvent)</code> 而是传递到 <code>onGenericMotionEvent(MotionEvent)</code> 。</li>
</ol>
<hr>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://SchafferWang0818.github.io/2018/03/21/Android之自定义控件——Canvas绘制参考/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="SchafferWang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://b107.photo.store.qq.com/psb?/V13TTKNS3RSxL2/w9lSgrOJ.PUBfNGq5Og3KsXpTRlFWY*M0I168fsA4us!/b/dGsAAAAAAAAA&bo=VgOAAgAAAAAFB*M!&rf=viewer_4">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SchafferWang's blogs">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/21/Android之自定义控件——Canvas绘制参考/" itemprop="url">Canvas 绘制</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-21T13:35:40+08:00">
                2018-03-21
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/android-总结/" itemprop="url" rel="index">
                    <span itemprop="name">android 总结</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Canvas-绘制"><a href="#Canvas-绘制" class="headerlink" title="Canvas 绘制"></a>Canvas 绘制</h1><pre><code>目录:
    1. 图片文字绘制
    2. 零散内容绘制和画布调整
</code></pre><hr>
<h2 id="Canvas图片文字绘制"><a href="#Canvas图片文字绘制" class="headerlink" title="Canvas图片文字绘制"></a>Canvas图片文字绘制</h2><pre><code>概要:
    1. 绘制图片
    2. 绘制文字
</code></pre><h3 id="1-绘制图片"><a href="#1-绘制图片" class="headerlink" title="1. 绘制图片"></a>1. 绘制图片</h3><h4 id="矢量-drawPicture"><a href="#矢量-drawPicture" class="headerlink" title="-   矢量(drawPicture)"></a>-   矢量(drawPicture)</h4><p>警告:需要关闭硬件加速.</p>
<ul>
<li>矢量图绘制就是记录Canvas绘制的内容. </li>
<li><p>Picture的相关函数</p>
<pre><code>- getWidth\height():得到宽高
- beginRecording(int width,int height):开始录制,return Canvas;
- endRecording():结束录制;
- draw(Canvas canvas):绘制矢量图;
</code></pre></li>
<li><p>矢量图的绘制有以下三种方式:</p>
<ol>
<li><p>mPic.draw(canvas);</p>
<ul>
<li>低版本<strong>影响canvas的状态</strong>,一般不使用;</li>
</ul>
</li>
<li><p>canvas.drawPicture(mPic);</p>
<ul>
<li><p><strong>不影响canvas状态,可以设置显示矢量图的区域矩形大小,完全压缩显示.</strong></p>
<pre><code>public void drawPicture (Picture picture)

public void drawPicture (Picture picture, Rect dst)

public void drawPicture (Picture picture, RectF dst)                
</code></pre></li>
</ul>
</li>
<li><p>picture → pictureDrawable → pictureDrawable.draw(canvas),<strong>不会缩放,按显示区域大小显示一部分</strong>;</p>
<pre><code>// 包装成为Drawable
PictureDrawable drawable = new PictureDrawable(mPicture);
// 设置绘制区域 -- 注意此处所绘制的实际内容不会缩放
drawable.setBounds(0,0,250,mPicture.getHeight());
// 绘制
drawable.draw(canvas);
</code></pre></li>
</ol>
</li>
</ul>
<h4 id="位图-drawBitmap"><a href="#位图-drawBitmap" class="headerlink" title="-   位图(drawBitmap)"></a>-   位图(drawBitmap)</h4><p>可能会消耗大量的内存,或者会造成内存泄露;<br>首先获得bitmap,然后进行绘制.</p>
<ol>
<li><p>获取</p>
<ol>
<li><p>资源文件(drawable/mipmap/raw):</p>
<pre><code>Bitmap bitmap = BitmapFactory.decodeResource
(mContext.getResources(),R.raw.bitmap);
</code></pre></li>
<li><p>资源文件(assets):</p>
<pre><code>Bitmap bitmap=null;
try {
    InputStream is = mContext.getAssets()
    .open(&quot;bitmap.png&quot;);
    bitmap = BitmapFactory.decodeStream(is);
    is.close();
} catch (IOException e) {
    e.printStackTrace();
}
</code></pre></li>
<li><p>内存卡文件:</p>
<pre><code>Bitmap bitmap = BitmapFactory
    .decodeFile(&quot;/sdcard/.../bitmap.png&quot;);
</code></pre></li>
<li><p>网络文件:</p>
<pre><code>// 此处省略了获取网络输入流的代码
Bitmap bitmap = BitmapFactory.decodeStream(is);
is.close();
</code></pre></li>
</ol>
</li>
<li><p>绘制</p>
<pre><code>public void drawBitmap 
1. (Bitmap bitmap, Matrix matrix, Paint paint)
2. (Bitmap bitmap, float left, float top, Paint paint)
3. (Bitmap bitmap, Rect src, Rect dst, Paint paint)
4. (Bitmap bitmap, Rect src, RectF dst, Paint paint)

1. 默认绘制起点为原点.
    `canvas.drawBitmap(bitmap,new Matrix(),new Paint());`
2. 确定一个绘制起点坐标.
3. 4.指定图片的绘制矩形区域和图片在屏幕上的绘制矩形区域,当前者宽/高度&gt;后者宽/高度的情况下会压缩.

canvas.translate(mWidth/2,mHeight/2);
// 指定图片绘制区域(左上角的四分之一)
Rect src = new Rect(0,0,bitmap.getWidth()/2,bitmap.getHeight()/2);
// 指定图片在屏幕上显示的区域
Rect dst = new Rect(0,0,200,400);
// 绘制图片
canvas.drawBitmap(bitmap,src,dst,null);

4. 注:可以控制两个区域的大小来完成某个动画.
</code></pre></li>
</ol>
<h3 id="2-绘制文字"><a href="#2-绘制文字" class="headerlink" title="2. 绘制文字"></a>2. 绘制文字</h3><pre><code>画笔Paint文本相关函数:
色彩    setColor,setARGB,setAlpha  设置颜色，透明度
大小    setTextSize                   设置文本字体大小
字体    setTypeface                   设置或清除字体样式
样式    setStyle                   填充描边等
对齐    setTextAlign               左,居中,右
测量    measureText                   测量文本大小

(注意:measureText()在设置完文本各项参数后调用)
</code></pre><ol>
<li>指定文本基线位置(x,y)</li>
</ol>
<pre><code>    public void drawText 
    (String text, float x, float y, Paint paint)
    (String text, int start, int end, float x, float y, Paint paint)
    (CharSequence text, int start, int end, float x, float y, Paint paint)
    (char[] text, int index, int count, float x, float y, Paint paint)


* 截取的字符串的index∈[start,end),index从0开始,
* count指截取的char字符数;
</code></pre><ol>
<li><p>指定每个文字的位置(不建议使用)</p>
<pre><code>public void drawPosText 
(String text, float[] pos, Paint paint)
(char[] text, int index, int count, float[] pos, Paint paint)
</code></pre><ul>
<li><p>例:</p>
<pre><code>canvas.drawPosText(str,new float[]{
      100,100,    // 第一个字符位置
      200,200,    // 第二个字符位置
      300,300,    // ...
      400,400,
      500,500},
textPaint);
</code></pre></li>
<li><p>缺点:</p>
<ol>
<li>必须指定所有字符位置，否则直接crash掉，反人类设计</li>
<li>性能不佳，在大量使用的时候可能导致卡顿</li>
<li>不支持emoji等特殊字符，不支持字形组合与分解        </li>
</ol>
</li>
</ul>
</li>
</ol>
<ol>
<li><p>指定路径来绘制文字</p>
<pre><code>public void drawTextOnPath 
(String text, Path path, float hOffset, float vOffset, Paint paint)
(char[] text, int index, int count, Path path, float hOffset, float vOffset, Paint paint)
</code></pre></li>
</ol>
<hr>
<h2 id="Canvas内容绘制"><a href="#Canvas内容绘制" class="headerlink" title="Canvas内容绘制"></a>Canvas内容绘制</h2><pre><code>- 绘制颜色
    - 主要函数:drawColor, drawRGB, drawARGB
    - 使用单一颜色填充整个画布
- 绘制基本形状
    - 主要函数:drawPoint, drawPoints, drawLine, drawLines, drawRect, drawRoundRect, drawOval, drawCircle, drawArc    
    - 依次为 点、线、矩形、圆角矩形、椭圆、圆、圆弧
- 绘制图片
    - 主要函数:drawBitmap, drawPicture
    - 绘制位图和图片
- 绘制文本    
    - drawText, drawPosText, drawTextOnPath    
    - 依次为 绘制文字、绘制文字时指定每个文字位置、根据路径绘制文字
- 绘制路径    
    - drawPath    
    - 绘制路径，绘制贝塞尔曲线时也需要用到该函数
- 顶点操作    
    - drawVertices, drawBitmapMesh    
    - 通过对顶点操作可以使图像形变，drawVertices直接对画布作用、 drawBitmapMesh只对绘制的Bitmap作用
- 画布剪裁    
    - clipPath, clipRect    
    - 设置画布的显示区域
- 画布快照    
    - save, restore, saveLayerXxx, restoreToCount, getSaveCount    
    - 依次为 保存当前状态、回滚到上一次保存的状态、 保存图层状态、 回滚到指定状态、 获取保存次数
- 画布变换    
    - translate, scale, rotate, skew    
    - 依次为 位移、缩放、 旋转、错切
- Matrix(矩阵)    
    - getMatrix, setMatrix, concat    
    - 实际上画布的位移，缩放等操作的都是图像矩阵Matrix， 只不过Matrix比较难以理解和使用，故封装了一些常用的方法。
</code></pre><h3 id="绘制画布颜色"><a href="#绘制画布颜色" class="headerlink" title="绘制画布颜色"></a>绘制画布颜色</h3><pre><code>canvas.drawColor(int color);
</code></pre><h4 id="绘制一个或者多个坐标点"><a href="#绘制一个或者多个坐标点" class="headerlink" title="绘制一个或者多个坐标点"></a>绘制一个或者多个坐标点</h4><pre><code>canvas.drawPoint(200, 200, mPaint);    
 //在坐标(200,200)位置绘制一个点
canvas.drawPoints(new float[]{          
//绘制一组点，坐标位置由float数组指定
      500,500,
      500,600,
      500,700
},mPaint);
</code></pre><h3 id="绘制形状"><a href="#绘制形状" class="headerlink" title="绘制形状"></a>绘制形状</h3><h4 id="1-线-—-每两个点确定一条线段"><a href="#1-线-—-每两个点确定一条线段" class="headerlink" title="1. 线 —- 每两个点确定一条线段"></a>1. 线 —- 每两个点确定一条线段</h4><pre><code>canvas.drawLine(300,300,500,600,mPaint);    
// 在坐标(300,300)(500,600)之间绘制一条直线
canvas.drawLines(new float[]{               
// 绘制一组线 每四数字(两个点的坐标)确定一条线
    100,200,200,200,
    100,300,200,300
},mPaint);
</code></pre><h4 id="2-矩形-—-两个对角线确定一个矩形"><a href="#2-矩形-—-两个对角线确定一个矩形" class="headerlink" title="2. 矩形 —- 两个对角线确定一个矩形"></a>2. 矩形 —- 两个对角线确定一个矩形</h4><pre><code>// 第一种
canvas.drawRect(100,100,800,400,mPaint);

// 第二种
Rect rect = new Rect(100,100,800,400);
canvas.drawRect(rect,mPaint);

// 第三种
RectF rectF = new RectF(100,100,800,400);
canvas.drawRect(rectF,mPaint);

Rect和RectF的区别在于int 和 float精度,方法也不相同;
</code></pre><h4 id="3-圆角矩形-—-矩形-内切椭圆的两个半径-半径大于矩形一半的宽度按一半来算"><a href="#3-圆角矩形-—-矩形-内切椭圆的两个半径-半径大于矩形一半的宽度按一半来算" class="headerlink" title="3. 圆角矩形 —- 矩形 + 内切椭圆的两个半径(半径大于矩形一半的宽度按一半来算)"></a>3. 圆角矩形 —- 矩形 + 内切椭圆的两个半径(半径大于矩形一半的宽度按一半来算)</h4><pre><code>// 第一种
RectF rectF = new RectF(100,100,800,400);
canvas.drawRoundRect(rectF,30,30,mPaint);

// 第二种
canvas.drawRoundRect(100,100,800,400,30,30,mPaint);
</code></pre><h4 id="4-椭圆-—-矩形的内切椭圆-只需给定矩形"><a href="#4-椭圆-—-矩形的内切椭圆-只需给定矩形" class="headerlink" title="4. 椭圆 —- 矩形的内切椭圆,只需给定矩形"></a>4. 椭圆 —- 矩形的内切椭圆,只需给定矩形</h4><pre><code>// 第一种
RectF rectF = new RectF(100,100,800,400);
canvas.drawOval(rectF,mPaint);

// 第二种
canvas.drawOval(100,100,800,400,mPaint);
</code></pre><h4 id="5-圆-—-圆心-半径"><a href="#5-圆-—-圆心-半径" class="headerlink" title="5. 圆 —- 圆心 + 半径"></a>5. 圆 —- 圆心 + 半径</h4><pre><code>canvas.drawCircle(500,500,400,mPaint);  
// 绘制一个圆心坐标在(500,500)，半径为400 的圆。
</code></pre><h4 id="6-圆弧-—-矩形内切椭圆-开始角度-结束角度-是否使用中心"><a href="#6-圆弧-—-矩形内切椭圆-开始角度-结束角度-是否使用中心" class="headerlink" title="6. 圆弧 —- 矩形内切椭圆 + 开始角度 + 结束角度 + 是否使用中心"></a>6. 圆弧 —- 矩形内切椭圆 + 开始角度 + 结束角度 + 是否使用中心</h4><pre><code>// 第一种
public void drawArc(@NonNull RectF oval, float startAngle, float sweepAngle, boolean useCenter, @NonNull Paint paint)

// 第二种
public void drawArc(float left, float top, float right, float bottom, float startAngle,
float sweepAngle, boolean useCenter, @NonNull Paint paint)
</code></pre><h3 id="Paint"><a href="#Paint" class="headerlink" title="Paint"></a>Paint</h3><ol>
<li>类型setStyle(int style)<ol>
<li>Paint.Style.STROKE:描边 </li>
<li>Paint.Style.FILL:填充</li>
<li>Paint.Style.FILL_AND_STROKE:描边+填充</li>
</ol>
</li>
<li><p>描边宽度</p>
<pre><code>paint.setStrokeWidth(40);
</code></pre></li>
<li><p>抗锯齿</p>
<pre><code>setAntiAlias(true);
</code></pre></li>
</ol>
<h3 id="Canvas"><a href="#Canvas" class="headerlink" title="Canvas"></a>Canvas</h3><ol>
<li><p>快照和回滚</p>
<ol>
<li><p>基础</p>
<p> 快照 : save();            //保存画布状态<br> 回滚 : restore();        //取出最后一次入栈的图层</p>
<p> save就是图层入栈,restore就是图层出栈;    </p>
</li>
<li><p>对应的API:</p>
<pre><code>save()                把当前的画布的状态进行保存，
或save(saveFlags)    然后放入特定的栈中

    ALL_SAVE_FLAG                默认，保存全部状态
    CLIP_SAVE_FLAG                保存剪辑区
    CLIP_TO_LAYER_SAVE_FLAG        剪裁区作为图层保存
    FULL_COLOR_LAYER_SAVE_FLAG    保存图层的全部色彩通道
    HAS_ALPHA_LAYER_SAVE_FLAG    保存图层的alpha(不透明度)通道
    MATRIX_SAVE_FLAG            保存Matrix信息( translate, rotate, scale, skew)

saveLayerXxx        新建一个图层，并放入特定的栈中

    saveLayerXxx,导致图层叠加造成计算量增倍而过度渲染.

    // 无图层alpha(不透明度)通道
    public int saveLayer 
    (RectF bounds, Paint paint)
    (RectF bounds, Paint paint, int saveFlags)
    (float left, float top, float right, float bottom, Paint paint)
    (float left, float top, float right, float bottom, Paint paint, int saveFlags)
    // 有图层alpha(不透明度)通道
    public int saveLayerAlpha (....,int alpha)

restore                把栈中最顶层的画布状态取出来，
                    并按照这个状态恢复当前的画布

restoreToCount        弹出指定位置及其以上所有的状态，
                    并按照指定位置的状态进行恢复

getSaveCount        获取栈中内容的数量(即保存次数)
</code></pre></li>
</ol>
</li>
<li><p>位移(不断叠加),基于上一次位置的移动.</p>
<pre><code>canvas.translate(200,200);
</code></pre></li>
<li><p>旋转(不断叠加),根据<strong>某个中心位置或者原点</strong>旋转<strong>某个角度</strong>;</p>
<pre><code>public void rotate 
(float degrees)
(float degrees, float px, float py)
</code></pre></li>
<li><p>缩放(不断叠加),<strong>根据原点位置对x,y方向上的缩放比例,或者根据某个缩放中心的位置控制缩放比例;当缩放比例sx or sy &lt; 0时,会进行翻转相当于中心对称翻转;</strong></p>
<pre><code>public void scale (float sx, float sy)

public final void scale (float sx, float sy, float px, float py)
</code></pre></li>
</ol>
<ol>
<li><p>错切(不断叠加) - skew,<strong>在某个方向上倾斜对应的角度,填入的值为角度对应的tan值.</strong></p>
<pre><code>public void skew (float sx, float sy)

变换之后的值:
    X = x + sx * y
    Y = sy * x + y
</code></pre></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://SchafferWang0818.github.io/2018/03/21/Android之自定义控件——0.自定义过程/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="SchafferWang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://b107.photo.store.qq.com/psb?/V13TTKNS3RSxL2/w9lSgrOJ.PUBfNGq5Og3KsXpTRlFWY*M0I168fsA4us!/b/dGsAAAAAAAAA&bo=VgOAAgAAAAAFB*M!&rf=viewer_4">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SchafferWang's blogs">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/21/Android之自定义控件——0.自定义过程/" itemprop="url">View 自定义过程</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-21T13:35:40+08:00">
                2018-03-21
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/android-总结/" itemprop="url" rel="index">
                    <span itemprop="name">android 总结</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="自定义过程"><a href="#自定义过程" class="headerlink" title="自定义过程"></a>自定义过程</h1><p>包括 <code>View/ViewGroup</code> <strong>测量布局绘制体系</strong> 与 <strong>事件拦截体系</strong>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1. 测量布局绘制体系</span><br><span class="line">	- onMeasure</span><br><span class="line">	- onLayout</span><br><span class="line">	- onDraw</span><br><span class="line">2. 事件拦截体系</span><br><span class="line">	- onInterceptTouchEvent</span><br><span class="line">	- onTouchEvent</span><br></pre></td></tr></table></figure>
<h2 id="测量布局绘制体系"><a href="#测量布局绘制体系" class="headerlink" title="测量布局绘制体系"></a>测量布局绘制体系</h2><h3 id="onMeasure"><a href="#onMeasure" class="headerlink" title="onMeasure()"></a><code>onMeasure()</code></h3><ul>
<li><p><code>ViewGroup</code>传递测量算子给子控件,<strong>之后可以调用子控件的<code>measureWidth/measureHeight</code></strong>.</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">measureChildren(widthMeasureSpec,heightMeasureSpec);</span><br></pre></td></tr></table></figure>
</li>
<li><font color="red" face="黑体" size="5">通过判断子控件宽高和个数,和自身的 <code>SpecMode</code>判断并设置宽高参数,<strong>建议使用默认大小或<code>LayoutParams</code>参数进行相关设置,同时考虑自身<code>padding</code>和子控件的<code>margin</code>。</strong></font>

  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">int widthSpecSize  = MeasureSpec.getSize(widthMeasureSpec);</span><br><span class="line">int heightSpecSize = MeasureSpec.getSize(heightMeasureSpec);</span><br><span class="line">setMeasureDimension(widthSpecSize,heightSpecSize);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="onLayout"><a href="#onLayout" class="headerlink" title="onLayout()"></a><code>onLayout()</code></h3><ul>
<li><p><strong>当前函数可以使用 <code>measureWidth/measureHeight</code>.</strong></p>
</li>
<li><p>循环对子控件进行位置传递,需要叠加时需要叠加自身<code>padding</code>与 子控件的<code>margin</code>值;</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//子控件的位置坐标是相对于父容器的,padding=0 时从0开始;</span><br><span class="line">childView.layout(left,top,right,bottom);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="onDraw"><a href="#onDraw" class="headerlink" title="onDraw()"></a><code>onDraw()</code></h3><ul>
<li><strong>当前函数可以使用 <code>width/height</code>.</strong></li>
</ul>
<hr>
<h2 id="事件拦截体系"><a href="#事件拦截体系" class="headerlink" title="事件拦截体系"></a>事件拦截体系</h2><h3 id="onInterceptTouchEvent"><a href="#onInterceptTouchEvent" class="headerlink" title="onInterceptTouchEvent()"></a><code>onInterceptTouchEvent()</code></h3><h3 id="onTouchEvent"><a href="#onTouchEvent" class="headerlink" title="onTouchEvent()"></a><code>onTouchEvent()</code></h3><hr>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://SchafferWang0818.github.io/2018/03/21/Android之源码——框架源码分析/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="SchafferWang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://b107.photo.store.qq.com/psb?/V13TTKNS3RSxL2/w9lSgrOJ.PUBfNGq5Og3KsXpTRlFWY*M0I168fsA4us!/b/dGsAAAAAAAAA&bo=VgOAAgAAAAAFB*M!&rf=viewer_4">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SchafferWang's blogs">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/21/Android之源码——框架源码分析/" itemprop="url">框架源码原理分析</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-21T13:35:40+08:00">
                2018-03-21
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/android-总结/" itemprop="url" rel="index">
                    <span itemprop="name">android 总结</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="框架源码原理分析"><a href="#框架源码原理分析" class="headerlink" title="框架源码原理分析"></a>框架源码原理分析</h1><h3 id="Multidex"><a href="#Multidex" class="headerlink" title="Multidex"></a><code>Multidex</code></h3><hr>
<h3 id="Glide"><a href="#Glide" class="headerlink" title="Glide"></a><code>Glide</code></h3><ul>
<li>参考:<ul>
<li><a href="http://mp.weixin.qq.com/s/SoqLK7eoJYT15sSDorpr9g" target="_blank" rel="noopener"> <strong> 一篇文章带你完全掌握Glide图片加载框架 </strong> </a></li>
<li><a href="http://mp.weixin.qq.com/s/p5mIA6nuVEWZsWPHOCHcYw" target="_blank" rel="noopener"> <strong> 带你全面了解Glide 4的用法 </strong> </a></li>
<li><a href="http://mp.weixin.qq.com/s/ANc7ZJRe7UjpD0v8ioz0yA" target="_blank" rel="noopener"> <strong>实战，实现带进度的Glide图片加载功能 </strong> </a></li>
<li><a href="http://mp.weixin.qq.com/s/M12AzUNSeLq202GV5h_4PQ" target="_blank" rel="noopener"> <strong> 来学习一下Glide强大的图片变换功能吧 </strong> </a></li>
<li><a href="http://blog.csdn.net/guolin_blog/article/details/53939176" target="_blank" rel="noopener"> <strong> Android图片加载框架最全解析（二），从源码的角度理解Glide的执行流程 </strong> </a></li>
</ul>
</li>
</ul>
<hr>
<h3 id="Gson"><a href="#Gson" class="headerlink" title="Gson"></a><code>Gson</code></h3><ul>
<li><p>参考:</p>
<ul>
<li><a href="https://www.tuicool.com/articles/bAn6zu7" target="_blank" rel="noopener"> <strong>推酷 - Gson源码设计学习</strong> </a></li>
<li><a href="https://juejin.im/entry/59376ff9a22b9d00580d3d7d" target="_blank" rel="noopener"> <strong>掘金 - Gson 源码解析</strong> </a></li>
<li><a href="http://blog.csdn.net/Jsagacity/article/details/78123410" target="_blank" rel="noopener"> <strong>CSDN - Google官方Gson解析</strong> </a></li>
</ul>
</li>
<li><p><code>json to JavaBean</code></p>
</li>
</ul>
<p><img src="https://upload-images.jianshu.io/upload_images/6193428-e97afe8385100aeb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="1"></p>
<ul>
<li><code>JavaBean to json</code>    </li>
</ul>
<hr>
<h3 id="Retrofit-amp-OkHttp"><a href="#Retrofit-amp-OkHttp" class="headerlink" title="Retrofit &amp; OkHttp"></a><code>Retrofit &amp; OkHttp</code></h3><ul>
<li>参考:<ul>
<li><a href="http://blog.csdn.net/qq_24675479/article/details/79493948" target="_blank" rel="noopener"> <strong>retrofit源码分析 </strong> </a></li>
</ul>
</li>
</ul>
<ul>
<li>retrofit网络通信八步<ol>
<li>创建retrofit实例</li>
<li>定义一个网络请求接口中的方法添加注解</li>
<li>通过动态代理生成网络请求对象</li>
<li>通过网络请求适配器将网络请求对象进行平台适配(android ,java,IOS)</li>
<li>通过网络请求执行器 发起网络请求</li>
<li>通过数据转换器 解析数据</li>
<li>通过回调执行器，切换主线程</li>
<li>用户在主线程处理结果</li>
</ol>
</li>
</ul>
<hr>
<h3 id="Rxjava"><a href="#Rxjava" class="headerlink" title="Rxjava"></a><code>Rxjava</code></h3><ul>
<li>参考:<ul>
<li><a href=""> <strong> </strong> </a></li>
<li><a href=""> <strong> </strong> </a></li>
<li><a href=""> <strong> </strong> </a></li>
</ul>
</li>
</ul>
<hr>
<h3 id="EventBus"><a href="#EventBus" class="headerlink" title="EventBus"></a><code>EventBus</code></h3><ul>
<li>参考:<ul>
<li><a href=""> <strong> </strong> </a></li>
<li><a href=""> <strong> </strong> </a></li>
<li><a href=""> <strong> </strong> </a></li>
</ul>
</li>
</ul>
<hr>
<h3 id="热更新bugly-tinker"><a href="#热更新bugly-tinker" class="headerlink" title="热更新bugly / tinker"></a>热更新<code>bugly / tinker</code></h3><ul>
<li>参考:<ul>
<li><a href="http://blog.csdn.net/lzyzsd/article/details/49843581/" target="_blank" rel="noopener"> <strong>Android热更新实现原理</strong> </a></li>
<li><a href=""> <strong> </strong> </a></li>
<li><a href=""> <strong> </strong> </a></li>
</ul>
</li>
</ul>
<p>java运行时加载的类是通过ClassLoader来实现的,Android中使用PathClassLoader类作为Android的默认的类加载器， <code>PathClassLoader</code>其实实现的就是简单的从文件系统中加载类文件。BaseDexClassLoader将findClass方法委托给了pathList对象的findClass方法，pathList对象是在BaseDexClassLoader的构造函数中new出来的， 它的类型是<code>DexPathList</code>。</p>
<p><strong>一旦有类被成功加载，那么它的dex一定会出现在dexElements所对应的dex文件中</strong>，并且dexElements中出现的顺序也很重要，在dexElements前面出现的dex会被优先加载，一旦Class被加载成功，就会立即返回，也就是说，<strong>如果想做hotpatch，一定要保证我们的hotpacth dex文件出现在dexElements列表的前面。</strong></p>
<p>由于PathClassLoader.pathList.dexElements是private,就需要<strong>反射</strong>来修改。<br>构造我们自己的dex文件所对应的dexElements数组的时候，我们也可以采取一个比较取巧的方式，就是通过构造一个DexClassLoader对象来加载我们的dex文件，并且调用一次<code>dexClassLoader.loadClass(dummyClassName)</code>;<br>方法，这样，<code>dexClassLoader.pathList.dexElements</code>中，就会包含我们的dex，<strong>通过把<code>dexClassLoader.pathList.dexElements</code>插入到系统默认的<code>classLoader.pathList.dexElements</code>列表前面，就可以让系统优先加载我们的dex中的类</strong>，从而可以实现热更新了。</p>
<hr>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://SchafferWang0818.github.io/2018/03/21/Android之算法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="SchafferWang">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://b107.photo.store.qq.com/psb?/V13TTKNS3RSxL2/w9lSgrOJ.PUBfNGq5Og3KsXpTRlFWY*M0I168fsA4us!/b/dGsAAAAAAAAA&bo=VgOAAgAAAAAFB*M!&rf=viewer_4">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="SchafferWang's blogs">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/03/21/Android之算法/" itemprop="url">Untitled</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-03-21T13:35:40+08:00">
                2018-03-21
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="http://b107.photo.store.qq.com/psb?/V13TTKNS3RSxL2/w9lSgrOJ.PUBfNGq5Og3KsXpTRlFWY*M0I168fsA4us!/b/dGsAAAAAAAAA&bo=VgOAAgAAAAAFB*M!&rf=viewer_4"
                alt="SchafferWang" />
            
              <p class="site-author-name" itemprop="name">SchafferWang</p>
              <p class="site-description motion-element" itemprop="description">我要一步一步往上爬，<br>只待阳光静静看着它的脸，<br>小小的天有大大的梦想，<br>重重的壳裹着轻轻的仰望。</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">89</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                
                  <span class="site-state-item-count">1</span>
                  <span class="site-state-item-name">categories</span>
                
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">79</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/SchafferWang0818" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-globe"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://weibo.com/5055805571/profile?topnav=1&wvr=6" target="_blank" title="Weibo">
                      
                        <i class="fa fa-fw fa-globe"></i>Weibo</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.zhihu.com/people/schaffer.me/activities" target="_blank" title="ZhiHu">
                      
                        <i class="fa fa-fw fa-globe"></i>ZhiHu</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">SchafferWang</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
